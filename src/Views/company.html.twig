<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entreprises</title>
    <link rel="stylesheet" href="/assets/0.css">
    <link rel="stylesheet" href="/assets/search.css">
    <link rel="stylesheet" href="/assets/overlay.css">

    <link rel="icon" type="image/png" href="images/Logo_cesi_2022.png">
</head>

<body>
    {% include 'header.twig' %}
    
    <div id="popup-overlay">
        <div class="popup-content">
            <h2>Déposez votre candidature</h2>
            <p class="subtitle">Nous sommes ravis que vous souhaitiez nous rejoindre.</p>
            <form id="application-form" method="post">
                <div class="form-group">
                    <label for="cv">CV (PDF)</label>
                    <input type="file" id="cv" name="cv" accept=".pdf" required>
                </div>

                <div class="form-group">
                    <label for="motivation">Lettre de motivation</label>
                    <textarea id="motivation" name="motivation" rows="5" placeholder="Exprimez votre motivation..." required></textarea>
                </div>
                <input type="hidden" id="offer-id" name="offer_id">
                <button type="submit" class="submit-btn">Envoyer ma candidature</button>
            </form>
            <a href="javascript:void(0)" onclick="togglePopup()" class="popup-exit">×</a>
        </div>
    </div>
    <form method="get">
        <main class="bloc-page">
            <aside class="bloc-filters">
                <h2>Filtres</h2>

                <!-- Type de contrat -->
                <h3>Type de contrat</h3>
                <label><input type="checkbox" name="contrat[]" value="stage" {% if 'stage' in contrats %}checked{% endif %}> Stage</label>
                <label><input type="checkbox" name="contrat[]" value="cdd" {% if 'cdd' in contrats %}checked{% endif %}> CDD</label>
                <label><input type="checkbox" name="contrat[]" value="cdi" {% if 'cdi' in contrats %}checked{% endif %}> CDI</label>
                <label><input type="checkbox" name="contrat[]" value="alternance" {% if 'alternance' in contrats %}checked{% endif %}> Alternance</label>

                <!-- Salaire -->
                <h3>Salaire</h3>
                <div class="salaire-container">
                    <label class="salaire-label">Min :</label>
                    <input type="range" name="salaire" min="0" max="10000" value="{{ salaire }}" class="salaire-range">
                    <span class="salaire-valeur">{{ salaire }} €</span>
                </div>

                <!-- Télétravail -->
                <h3>Télétravail</h3>
                <label><input type="checkbox" name="teletravail" value="oui" {% if teletravail == 'oui' %}checked{% endif %}> Télétravail possible</label>

                <!-- Durée du stage -->
                <h3>Durée du stage</h3>
                <select name="duree">
                    <option value="">-- Sélectionner --</option>
                    <option value="1" {% if duree == '1' %}selected{% endif %}>1 mois</option>
                    <option value="3" {% if duree == '3' %}selected{% endif %}>3 mois</option>
                    <option value="6" {% if duree == '6' %}selected{% endif %}>6 mois</option>
                </select>

                <!-- Niveau d'étude -->
                <h3>Niveau d'étude</h3>
                <select name="niveau_etude">
                    <option value="">-- Sélectionner --</option>
                    <option value="Bac" {% if niveau_etude == 'Bac' %}selected{% endif %}>Bac</option>
                    <option value="bac+2" {% if niveau_etude == 'bac+2' %}selected{% endif %}>Bac +2</option>
                    <option value="bac+5" {% if niveau_etude == 'bac+5' %}selected{% endif %}>Bac +5</option>
                </select>
                
                <div class="bloc-pagination">
                    <button type="submit">Appliquer</button>
                </div>
            </aside>


            <section class="bloc-search">
                <div class="bloc-search-bar">
                    <input type="text" placeholder="Rechercher un stage" name="search-bar" value="{{ search }}">
                </div>

                <div class="bloc-result">
                    {% for entreprise in entreprises %}
                    <div class="offre">
                        <div class="offre-header">
                            <h2>{{ entreprise.nom }}</h2>
                            <div class="offre-buttons">

                            </div>
                        </div>
                        <div class="offre-details">
                            <p><strong>Secteur :</strong> {{ secteur.secteur }}</p>
                            <p><strong>Contact :</strong> {{ entreprise.mail }}</p>
                            <p><strong>Localisation :</strong> {{ place.ville }}</p>
                            
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <!-- Pagination avec un seul formulaire -->
                <div class="bloc-pagination">
                    {% if pageActuelle > 1 %}
                        <button type="submit" name="page" value="{{ pageActuelle - 1 }}">Précédent</button>
                    {% endif %}

                    <span>
                        <p>Page {{ pageActuelle }} sur {{ totalPages }}</p>
                    </span>

                    {% if pageActuelle < totalPages %}
                        <button type="submit" name="page" value="{{ pageActuelle + 1 }}">Suivant</button>
                    {% endif %}
                </div>
            </section>
        </main>
    </form>

    {% include 'footer.twig' %}
    <script src="../../scripts/popup.js"></script>
</body>

</html>
